<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigator - Home Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="min-h-screen w-full flex">
        <!-- Sidebar will load here -->
        <div id="sidebar-container">Loading sidebar...</div>
        
        <!-- Main content area -->
        <div class="flex-1 flex flex-col">
            <!-- Header will load here -->
            <div id="header-container">Loading header...</div>
            
            <!-- Page content -->
            <main id="main-content" class="flex-1 p-6 sm:p-8 overflow-y-auto">
                <h2>Welcome to Navigator</h2>
                <p>Home dashboard will load here...</p>
            </main>
        </div>
    </div>

    <!-- Load shared JavaScript FIRST -->
    <script src="js/shared.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // Load components
            const sidebarContainer = document.getElementById('sidebar-container');
            const sidebarHTML = await ComponentLoader.loadSidebar();
            sidebarContainer.innerHTML = sidebarHTML;
            
            const headerContainer = document.getElementById('header-container');
            const headerHTML = await ComponentLoader.loadHeader();
            headerContainer.innerHTML = headerHTML;
            
            // Load home dashboard content
            loadHomeDashboard();
        });
        
       function loadHomeDashboard() {
    const mainContent = document.getElementById('main-content');
    
    // Portfolio pipeline data
    const pipelineStages = [
        { name: 'Due Diligence', count: 1, color: '#0ea5e9' },
        { name: 'Strategize', count: 3, color: '#14b8a6' },
        { name: 'Transform', count: 2, color: '#8b5cf6' },
        { name: 'Grow', count: 1, color: '#22c55e' },
        { name: 'Exit', count: 0, color: '#64748b' }
    ];
    
    // Portfolio companies data
    const companies = [
        { 
            id: 'techflow-solutions', 
            name: 'TechFlow Solutions', 
            stage: 'Due Diligence', 
            arr: 55, 
            nrr: 105, 
            ebitda: 22, 
            status: 'At Risk', 
            statusColor: 'bg-yellow-500', 
            stageColor: 'bg-sky-100 text-sky-800' 
        },
        { 
            id: 'innovate-inc', 
            name: 'Innovate Inc.', 
            stage: 'Transform', 
            arr: 120, 
            nrr: 122, 
            ebitda: 18, 
            status: 'Healthy', 
            statusColor: 'bg-green-500', 
            stageColor: 'bg-violet-100 text-violet-800' 
        },
        { 
            id: 'dataflow-systems', 
            name: 'DataFlow Systems', 
            stage: 'Strategize', 
            arr: 32, 
            nrr: 115, 
            ebitda: 25, 
            status: 'Healthy', 
            statusColor: 'bg-green-500', 
            stageColor: 'bg-teal-100 text-teal-800' 
        },
        { 
            id: 'cloudvantage', 
            name: 'CloudVantage', 
            stage: 'Grow', 
            arr: 78, 
            nrr: 128, 
            ebitda: 31, 
            status: 'Healthy', 
            statusColor: 'bg-green-500', 
            stageColor: 'bg-green-100 text-green-800' 
        },
        { 
            id: 'scaleops', 
            name: 'ScaleOps', 
            stage: 'Strategize', 
            arr: 19, 
            nrr: 108, 
            ebitda: 12, 
            status: 'Needs Attention', 
            statusColor: 'bg-orange-500', 
            stageColor: 'bg-teal-100 text-teal-800' 
        }
    ];

    mainContent.innerHTML = `
        <!-- Alert Banner -->
        <div class="bg-red-100 border-l-4 border-red-500 text-red-800 p-4 mb-8 rounded-r-lg" role="alert">
            <div class="flex">
                <div class="py-1">
                    <svg class="fill-current h-6 w-6 text-red-500 mr-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                        <path d="M2.93 17.07A10 10 0 1 1 17.07 2.93 10 10 0 0 1 2.93 17.07zM9 5v6h2V5H9zm0 8v2h2v-2H9z"/>
                    </svg>
                </div>
                <div>
                    <p class="font-bold">Action Required: TechFlow Solutions</p>
                    <p class="text-sm">Due diligence has uncovered 3 critical anomalies. Resolution is pending before proceeding.</p>
                </div>
            </div>
        </div>

        <!-- Portfolio-wide KPIs -->
        <h2 class="text-xl font-semibold text-gray-700 mb-4">Portfolio-wide KPIs</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                <p class="text-sm font-bold text-gray-700 mb-1">Portfolio Enterprise Value</p>
                <p class="text-3xl font-bold text-blue-600">$2.4B</p>
                <p class="text-sm text-green-600 mt-1">+12% vs target</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                <p class="text-sm font-bold text-gray-700 mb-1">Active Programs</p>
                <p class="text-3xl font-bold text-indigo-600">15</p>
                <p class="text-sm text-gray-500 mt-1">across 8 companies</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                <p class="text-sm font-bold text-gray-700 mb-1">Avg. MOIC Target</p>
                <p class="text-3xl font-bold text-green-600">2.3x</p>
                <p class="text-sm text-green-600 mt-1">+0.3x vs industry</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md border border-gray-100">
                <p class="text-sm font-bold text-gray-700 mb-1">Avg. Time to Value</p>
                <p class="text-3xl font-bold text-purple-600">18 mos</p>
                <p class="text-sm text-green-600 mt-1">-50% vs traditional</p>
            </div>
        </div>

        <!-- Program Execution Pipeline -->
        <h2 class="text-xl font-semibold text-gray-700 mb-6">Program Execution Pipeline</h2>
        <div class="flex w-full overflow-x-auto pb-2 mb-10">
            ${pipelineStages.map((stage, index) => `
                <div class="flex-grow min-w-[180px] sm:min-w-[200px] chevron-item" style="--bg-color: ${stage.color}; z-index: ${pipelineStages.length - index};">
                    <span class="flex-grow text-center text-sm sm:text-base">${stage.name}</span>
                    <span class="flex-shrink-0 flex items-center justify-center w-8 h-8 text-sm rounded-full bg-white/25 font-bold">${stage.count}</span>
                </div>
            `).join('')}
        </div>

        <!-- Portfolio Company Overview -->
        <h2 class="text-xl font-semibold text-gray-700 mb-4">Portfolio Company Overview</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
            ${companies.map(company => `
                <div class="bg-white p-4 rounded-lg shadow-md border border-gray-100 flex flex-col justify-between hover:shadow-xl hover:border-sky-400 transition-all cursor-pointer" 
                     onclick="navigateToCompany('${company.id}')">
                    <div>
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="font-bold text-lg text-gray-800">${company.name}</h3>
                            <span class="text-xs font-semibold px-2 py-1 rounded-full ${company.stageColor}">${company.stage}</span>
                        </div>
                        <div class="flex justify-between text-center border-t border-b py-3 my-3">
                            <div>
                                <p class="text-sm text-gray-500">ARR</p>
                                <p class="font-semibold text-gray-800">$${company.arr}M</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">NRR</p>
                                <p class="font-semibold text-gray-800">${company.nrr}%</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-500">EBITDA</p>
                                <p class="font-semibold text-gray-800">${company.ebitda}%</p>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center justify-start gap-2 text-sm">
                        <span class="h-3 w-3 rounded-full ${company.statusColor} inline-block"></span>
                        <span>${company.status}</span>
                    </div>
                </div>
            `).join('')}
            
            <!-- Add Company Card -->
            <div class="bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center text-gray-500 hover:bg-gray-100 hover:border-gray-400 cursor-pointer min-h-[180px]">
                <div class="text-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="mx-auto h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                    </svg>
                    <p class="mt-2 font-semibold">Add Company</p>
                </div>
            </div>
        </div>
    `;
}

// Add navigation function for company cards
function navigateToCompany(companyId) {
    // Store the selected company
    localStorage.setItem('selectedCompany', companyId);
    
    // Navigate to the PortCo page
    window.location.href = `portco.html?company=${companyId}`;
}
    </script>
</body>
</html>